<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>The Chi-Squared Distribution and Its Connection to Discrete Data | John Moïse</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="../_observablehq/theme-air.css">
<link rel="preload" as="style" href="../_npm/katex@0.16.10/dist/katex.min.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="../_observablehq/theme-air.css">
<link rel="stylesheet" type="text/css" href="../_npm/katex@0.16.10/dist/katex.min.css">
<link rel="modulepreload" href="../_observablehq/client.js">
<link rel="modulepreload" href="../_observablehq/runtime.js">
<link rel="modulepreload" href="../_observablehq/stdlib.js">
<link rel="modulepreload" href="../_observablehq/stdlib/tex.js">
<link rel="modulepreload" href="../_npm/katex@0.16.10/_esm.js">
<link rel="icon" href="../_file/favicon.2e0bf1ca.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "../_observablehq/client.js";

define({id: "07ea1133", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-1", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-2", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "795b5447", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`X`
))
}});

define({id: "c6e34b72", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`X \sim \mathcal{N}(0,1)`
))
}});

define({id: "9919e91a", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`Y`
))
}});

define({id: "795b5447-1", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`X`
))
}});

define({id: "07ea1133-3", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "f4c68310", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`Y = X^2 \sim \chi_1^2`
))
}});

define({id: "caa4047c", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`F_Y(y)`
))
}});

define({id: "f030ad5e", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`f_Y(y)`
))
}});

define({id: "9c893c7e", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`\begin{align*}
F_Y(y) & = P(X^2\lt y) = P(-\sqrt{y}\lt X \lt \sqrt{y}) \\
& = F_X(\sqrt{y})-F_X(-\sqrt{y}) \\
& = F_X(\sqrt{y})-(1-F_X(\sqrt{y})) \\
& = 2F_X(\sqrt{y}) - 1 \\
\end{align*}`
))
}});

define({id: "0a2386f0", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`\begin{align*}
f_Y(y) & = \frac{d}{dy}F_Y(y) \\
& = \frac{d}{dy}\left[2F_X(\sqrt{y}) - 1\right] \\
& = \frac{d}{dy}\left[2\int_{\infty}^{\sqrt{y}}\frac{1}{\sqrt{2\pi}}e^{-\frac{t^2}{2}}dt \right] \\
& = \frac{1}{\sqrt{2\pi}}y^{-\frac{1}{2}}e^{-\frac{y}{2}}\\
\end{align*}`
))
}});

define({id: "643c39c0", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`k`
))
}});

define({id: "9919e91a-1", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`Y`
))
}});

define({id: "643c39c0-1", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`k`
))
}});

define({id: "9919e91a-2", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`Y`
))
}});

define({id: "07ea1133-4", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "643c39c0-2", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`k`
))
}});

define({id: "69b46237", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`Y=\sum_{i=1}^{k}X_i^2 \sim \chi_k^2`
))
}});

define({id: "d6602cf3", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`X_1,...,X_k \sim \mathcal{N}(0,1)`
))
}});

define({id: "c3afd28b", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`x_1,...,x_k`
))
}});

define({id: "49162411", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`X_1,...,X_k`
))
}});

define({id: "0c6f4000", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`x = (x_1,...,x_k)`
))
}});

define({id: "3f07dbaa", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`y = \sum\_{i=1}^{k}x_i^2`
))
}});

define({id: "9919e91a-3", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`Y`
))
}});

define({id: "caa4047c-1", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`F_Y(y)`
))
}});

define({id: "f030ad5e-1", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`f_Y(y)`
))
}});

define({id: "79e709d2", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`\begin{align*}
F_Y(y) & = F_Y(y)\frac{dy}{dy} = f_Y(y)dy \\
& = \int_\mathcal{V} \prod_{i=1}^{k}\mathcal{N}(x_i;0,1)dx_i \\
& = \int_\mathcal{V} \frac{e^{-y/2}}{(2\pi)^{k/2}}dx_1 dx_2 \cdots dx_k \\
& = \frac{e^{-y/2}}{(2\pi)^{k/2}}\int_\mathcal{V} dx_1 dx_2 \cdots dx_k \\
\end{align*}`
))
}});

define({id: "473ef45d", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\mathcal{V}`
))
}});

define({id: "2ccc13e3", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`y`
))
}});

define({id: "ce0d8d66", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`A`
))
}});

define({id: "351ab760", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`(k − 1)`
))
}});

define({id: "d598b091", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`r=\sqrt{y}`
))
}});

define({id: "5902354b", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`dr`
))
}});

define({id: "ea0db12d", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`A = 2r^{k-1}\frac{\pi^{k/2}}{\Gamma(k/2)}\\[0.5em]
dr = \frac{1}{2}y^{-1/2}dy`
))
}});

define({id: "ffc38a83", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`\begin{align*}
f_Y(y)dy & = \frac{e^{-y/2}}{(2\pi)^{k/2}}\int_\mathcal{V} dx_1 dx_2 \cdots dx_k \\
& = \frac{e^{-y/2}}{(2\pi)^{k/2}} A dr \\
& = \frac{e^{-y/2}}{(2\pi)^{k/2}} \cdot 2\sqrt{y}^{k-1}\frac{\pi^{k/2}}{\Gamma(k/2)} \cdot \frac{1}{2}y^{-1/2}dy \\
& = \frac{y^{k/2-1}e^{-y/2}}{2^{k/2}\Gamma(k/2)}dy \\
\end{align*}`
))
}});

define({id: "562e01d0", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`f_Y(y) = \frac{y^{k/2-1}e^{-y/2}}{2^{k/2}\Gamma(k/2)}`
))
}});

define({id: "07ea1133-5", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "643c39c0-3", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`k`
))
}});

define({id: "07ea1133-6", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-7", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-8", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-9", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-10", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "795b5447-2", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`X`
))
}});

define({id: "beb7e92b", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`X = \frac{m-Np}{\sqrt{Npq}}`
))
}});

define({id: "10e9aa8d", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`N`
))
}});

define({id: "7fac2155", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`m`
))
}});

define({id: "543ad359", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`p`
))
}});

define({id: "88e990b7", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`q=(1-p)`
))
}});

define({id: "75b47bd8", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`N = Np + Nq `
))
}});

define({id: "5b53b306", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`N=m+(N-m)`
))
}});

define({id: "c8fe3ed0", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`\begin{align*}
X^2 & = \frac{(m-Np)^2}{Npq} \\
X^2 & = \frac{(m-Np)^2}{Np} + \frac{(N-m-Nq)^2}{Nq} \\
\end{align*}`
))
}});

define({id: "795b5447-3", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`X`
))
}});

define({id: "f8daa8c2", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`X^2`
))
}});

define({id: "07ea1133-11", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "b61cd358", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex.block`X^2 = \sum_{i=1}^{n}\frac{(O_i-E_i)^2}{E_i}`
))
}});

define({id: "07ea1133-12", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "ce2eaf94", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`O_i`
))
}});

define({id: "7d2b419a", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`E_i`
))
}});

define({id: "07ea1133-13", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-14", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

define({id: "07ea1133-15", mode: "inline", inputs: ["tex","display"], body: async (tex,display) => {
display(await(
tex`\chi^2`
))
}});

</script>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
<div>On This Page</div>
<ol>
<li class="observablehq-secondary-link"><a href="#deriving-the-distribution-with-a-single-degree-of-freedom">Deriving the distribution with a single degree of freedom</a></li>
<li class="observablehq-secondary-link"><a href="#deriving-the-distribution-with-arbitrary-degrees-of-freedom">Deriving the distribution with arbitrary degrees of freedom</a></li>
<li class="observablehq-secondary-link"><a href="#applying-the-distribution">Applying the  distribution</a></li>
</ol>
</nav>
</aside>
<div id="observablehq-center">
<header id="observablehq-header">
<div style="display: flex; justify-content: space-between; align-items: middle; gap: 1rem; padding: 1rem 1.5rem; margin: -2rem -1rem 2rem -1rem; border-bottom: solid 1px var(--theme-foreground-faintest)"><div style="display: flex; gap: 1rem; font-size: 20px;"><span>John Moïse</span></div><div style="display:inline-flex;align-items:center; gap: 1rem; font-size: 16px; vertical-align: middle;"><span><a href="../">Blog</a></span><span>Projects</span></div></div>
</header>
<main id="observablehq-main" class="observablehq">
<h1 id="the-distribution-and-its-connection-to-discrete-data" tabindex="-1">The <observablehq-loading></observablehq-loading><!--:07ea1133:--> Distribution and Its Connection to Discrete Data</h1>
<p>When I first learned of the <observablehq-loading></observablehq-loading><!--:07ea1133-1:--> distribution and its applications in my
introductory statistics course, I found it odd that the distribution is
continuous, yet most of the statistical procedures that use the distribution
apply to discrete, categorical data. I did not know enough at the time to even
begin attempting to investigate this discrete-continuous connection. Today we're
going to derive the <observablehq-loading></observablehq-loading><!--:07ea1133-2:--> distribution from scratch to see where it comes
from and hopefully gain a better intuition as to why it can be applied to
discrete data.</p>
<h2 id="deriving-the-distribution-with-a-single-degree-of-freedom" tabindex="-1">Deriving the distribution with a single degree of freedom</h2>
<p>First, we begin by defining the random variable <observablehq-loading></observablehq-loading><!--:795b5447:--> to be normally distributed
with mean of zero and variance of one.</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:c6e34b72:--></div>
<p>We next define the random variable <observablehq-loading></observablehq-loading><!--:9919e91a:--> as the square of <observablehq-loading></observablehq-loading><!--:795b5447-1:-->. This random
variable is said to be <observablehq-loading></observablehq-loading><!--:07ea1133-3:--> distributed with a single degree of freedom.</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:f4c68310:--></div>
<p>To derive the PDF of Y, we begin by defining the CDF <observablehq-loading></observablehq-loading><!--:caa4047c:--> which we then
differentiate to find the PDF <observablehq-loading></observablehq-loading><!--:f030ad5e:-->.</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:9c893c7e:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:0a2386f0:--></div>
<h2 id="deriving-the-distribution-with-arbitrary-degrees-of-freedom" tabindex="-1">Deriving the distribution with arbitrary degrees of freedom</h2>
<p>Now let's derive the PDF of the distribution with <observablehq-loading></observablehq-loading><!--:643c39c0:--> degrees of freedom.
We begin by defining the random variable <observablehq-loading></observablehq-loading><!--:9919e91a-1:--> to be the sum of <observablehq-loading></observablehq-loading><!--:643c39c0-1:-->
squared standard normal random variables. <observablehq-loading></observablehq-loading><!--:9919e91a-2:--> is then said to be
<observablehq-loading></observablehq-loading><!--:07ea1133-4:--> distributed with <observablehq-loading></observablehq-loading><!--:643c39c0-2:--> degrees of freedom.</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:69b46237:--></div>
<p>where</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:d6602cf3:--></div>
<p>Let <observablehq-loading></observablehq-loading><!--:c3afd28b:--> be values of <observablehq-loading></observablehq-loading><!--:49162411:--> and consider <observablehq-loading></observablehq-loading><!--:0c6f4000:--> to
represent a point in k-dimensional space. We define</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:3f07dbaa:--></div>
<p>As before, we will define the CDF of <observablehq-loading></observablehq-loading><!--:9919e91a-3:--> as <observablehq-loading></observablehq-loading><!--:caa4047c-1:--> and differentiate to find
the PDF, <observablehq-loading></observablehq-loading><!--:f030ad5e-1:-->.</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:79e709d2:--></div>
<p>The above integral over the shell volume <observablehq-loading></observablehq-loading><!--:473ef45d:--> at <observablehq-loading></observablehq-loading><!--:2ccc13e3:--> is
equivalent to the surface area <observablehq-loading></observablehq-loading><!--:ce0d8d66:--> of the <observablehq-loading></observablehq-loading><!--:351ab760:-->-sphere with
radius <observablehq-loading></observablehq-loading><!--:d598b091:--> times the infinitesimal thickness of the sphere <observablehq-loading></observablehq-loading><!--:5902354b:-->.</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:ea0db12d:--></div>
<p>We may now substitute back into our first equation.</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:ffc38a83:--></div>
<p>which implies</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:562e01d0:--></div>
<p>which is the PDF of the <observablehq-loading></observablehq-loading><!--:07ea1133-5:--> distribution with <observablehq-loading></observablehq-loading><!--:643c39c0-3:--> degrees of freedom!</p>
<h2 id="applying-the-distribution" tabindex="-1">Applying the <observablehq-loading></observablehq-loading><!--:07ea1133-6:--> distribution</h2>
<p>The <observablehq-loading></observablehq-loading><!--:07ea1133-7:--> distribution is used primarily in hypothesis testing, most
commonly in tests such as</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Pearson's_$%7Btex%60%5Cchi%5E2%60%7D_test#Test_for_fit_of_a_distribution" target="_blank" rel="noopener noreferrer"><observablehq-loading></observablehq-loading><!--:07ea1133-8:--> test of goodness of fit</a></li>
<li><a href="https://en.wikipedia.org/wiki/Pearson's_$%7Btex%60%5Cchi%5E2%60%7D_test#Testing_for_statistical_independence" target="_blank" rel="noopener noreferrer"><observablehq-loading></observablehq-loading><!--:07ea1133-9:--> test of independence</a></li>
<li><a href="https://en.wikipedia.org/wiki/Cochran%E2%80%93Mantel%E2%80%93Haenszel_statistics" target="_blank" rel="noopener noreferrer">Cochran-Mantel-Haenszel test for stratified data</a></li>
</ul>
<p>However, given that the distribution is continuous, I always thought it odd that
the most common applications of the distribution dealt strictly with discrete
data (such as those in contingency tables). It turns out that this use for
discrete data is founded on the very same reasoning that one uses to approximate
the normal distribution with the binomial distribution.</p>
<p>To show why Pearson was able to establish methods of hypothesis testing with
discrete data using the <observablehq-loading></observablehq-loading><!--:07ea1133-10:--> distribution, we first begin by defining the
following random variable <observablehq-loading></observablehq-loading><!--:795b5447-2:--> as follows:</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:beb7e92b:--></div>
<p>The right-hand side of the above equation, which derives from a binomial
distribution with <observablehq-loading></observablehq-loading><!--:10e9aa8d:--> events, <observablehq-loading></observablehq-loading><!--:7fac2155:--> successes, <observablehq-loading></observablehq-loading><!--:543ad359:--> probability
of success, and <observablehq-loading></observablehq-loading><!--:88e990b7:--> probability of failure, was shown by De Moivre
and Laplace to be asymptotically normal.</p>
<p>Squaring both sides of the equation and substituting <observablehq-loading></observablehq-loading><!--:75b47bd8:--> and <observablehq-loading></observablehq-loading><!--:5b53b306:-->, we receive</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:c8fe3ed0:--></div>
<p>Since <observablehq-loading></observablehq-loading><!--:795b5447-3:--> is asymptotically normal, <observablehq-loading></observablehq-loading><!--:f8daa8c2:--> asymptotically follows the <observablehq-loading></observablehq-loading><!--:07ea1133-11:-->
distribution. The above derivation only works for binomial systems, but using a
<a href="https://math.stackexchange.com/questions/2859095/approximating-a-multinomial-as-p-xi-1-ldots-xi-n-propto-exp-left-fracn" target="_blank" rel="noopener noreferrer">higher dimensional version of the same
argument</a>,
the final expression can be generalized to the form</p>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:b61cd358:--></div>
<p>which is the form that Pearson arrived at when establishing his <observablehq-loading></observablehq-loading><!--:07ea1133-12:-->
test (wherein <observablehq-loading></observablehq-loading><!--:ce2eaf94:--> and <observablehq-loading></observablehq-loading><!--:7d2b419a:--> correspond to the observed and expected
frequencies for each of the categorical outcomes). So, in effect, every time we are applying
a <observablehq-loading></observablehq-loading><!--:07ea1133-13:--> test to discrete data, whether it be in a contingency table or
in counts of outcomes, we are using a generalized form of the de Moivre-Laplace
theorem as the connection between the discrete and continuous. This is why
<observablehq-loading></observablehq-loading><!--:07ea1133-14:--> tests should not be applied in systems with limited data, as the
low counts make for a poor approximation of the <observablehq-loading></observablehq-loading><!--:07ea1133-15:--> distribution
(just as a binomial system with low counts poorly approximates the normal).</p>
</main>
</div>
